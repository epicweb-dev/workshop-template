# Epic Workshop anatomy (repo structure + conventions)

This is the **non-negotiable “shape”** of an Epic Workshop. Agents should follow this exactly unless there’s a strong reason not to.

## Core definitions

- **Workshop**: the entire repository.
- **Workshop app**: the Epic Workshop app that renders exercises and runs apps/tests.
- **Exercise**: each directory inside `exercises/` like `01.topic-name/`.
- **Exercise step**: each subdirectory inside an exercise like `01.problem.some-step/` and `01.solution.some-step/`.
- **Problem app**: the starting state for a step.
- **Solution app**: the finished state for a step.
- **Playground**: where learners do their work; “Set to Playground” copies a chosen app into `playground/`.

## Canonical directory structure

At a high level:

```
.
├── README.md
├── package.json
├── package-lock.json
├── epicshop/
│   ├── package.json
│   ├── setup.js
│   └── ... workshop app helpers ...
├── exercises/
│   ├── README.mdx
│   ├── FINISHED.mdx
│   ├── 01.some-exercise/
│   │   ├── README.mdx
│   │   ├── FINISHED.mdx
│   │   ├── 01.problem.some-step/
│   │   │   ├── README.mdx
│   │   │   └── ... app files ...
│   │   └── 01.solution.some-step/
│   │       ├── README.mdx
│   │       └── ... app files ...
│   └── 02.next-exercise/
│       └── ...
└── playground/
    └── (generated by “Set to playground”)
```

### Naming rules

- **Exercise directories**: `NN.exercise-title` (e.g. `01.js-hello-world`, `07.csrf`).
- **Step directories**: `NN.problem.step-name` and `NN.solution.step-name`.
- **All names should be lower-kebab-case**.
- Use **2-digit** exercise folders when possible (many repos do both; be consistent in a workshop).

## App types: “simple” vs “project”

The workshop app supports two app types:

### Simple app

If there is **no** `package.json` with a `dev` script in the app directory, it’s treated as a *simple app*.

Common patterns:

- `index.html` + inline `<script>` for early fundamentals steps.
- `index.tsx` / `index.ts` / `index.js` without an `index.html` (the workshop app can generate HTML).
- Optional `index.css`.

Simple apps can also include an `api.server.ts` (or `.js`, `.tsx`, etc.) exporting `loader` and/or `action` (Remix-like) for server-backed steps.

**Important**: simple apps are served from the workshop app; they are not fully isolated. If you need real server/runtime isolation, use a project app.

### Project app

If the app directory includes a `package.json` with a `dev` script, it’s treated as a *project app*.

The workshop app will:

- run `npm run dev` for that app (with a `PORT` env)
- iframe the running app

Therefore, **the app’s `dev` script must bind to `process.env.PORT`**.

## Instructions: required MDX files

These are the files instructors/agents must generate:

- `exercises/README.mdx`: workshop intro.
- `exercises/**/README.mdx`: exercise intro.
- `exercises/**/**.problem.*/README.mdx`: step problem instructions.
- `exercises/**/**.solution.*/README.mdx`: step solution instructions.
- `exercises/**/FINISHED.mdx`: exercise outro (reflection + feedback).
- `exercises/FINISHED.mdx`: workshop wrap-up.

> If the workshop is “launched” (published), all of the above should also embed an `EpicVideo`.

## Tests (how the workshop app decides to show the test tab)

The test tab appears when either is true:

1. The app has a `package.json` with a `test` script (the UI shows a button to run it).
2. The app has `*.test.*` files in its root (tests are compiled/bundled and run in-browser).

For simple apps, in-browser tests typically use `@epic-web/workshop-utils/test`.

## Diffs (how learners get unstuck)

The diff tab compares problem/solution (or playground/solution) while filtering noise.

It ignores:

- patterns from root `.gitignore`
- patterns from exercise `.gitignore` (if present)
- extra patterns from `epicshop/.diffignore` (root and/or per-exercise)

Use `.diffignore` if learners are overwhelmed by irrelevant file changes.

## Repo-level configuration (`package.json#epicshop`)

The root `package.json` should include an `epicshop` object with (at minimum):

- `title` (required)
- `githubRoot` or `githubRepo` (required for proper file links)

Common additions:

- `subtitle`
- `instructor` (name/avatar/xHandle)
- `product` (host/slug + optional discord metadata)
- `stackBlitzConfig`
- `testTab.enabled`
- `initialRoute`
- `scripts.postupdate`

